<script>
    function getAutoTheme() {
        if (window.matchMedia && 
            window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.classList.add("dark-theme");
                return "active";
            } else {
                document.documentElement.classList.remove("dark-theme");
                return "disactive";
            }
    }

    function setUpMode(mode, userTheme) {
        const switchMenu = document.querySelector(".header_theme-switch");
        const element = document.getElementById(`dark-theme-${mode}`);
        if (element && switchMenu) {
            element.classList.add("active");
            (mode === "sys" || ["active", "disactive"].find(e => e == mode) == undefined)? mode = userTheme : void(0);
            switchMenu.classList.add(`dark-theme-${mode}`);
            switch(mode) {
                case "disactive":
                    switchMenu.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="30" height="30" viewBox="0 0 30 30">
                            <path d="M 14.984375 0.98632812 A 1.0001 1.0001 0 0 0 14 2 L 14 5 A 1.0001 1.0001 0 1 0 16 5 L 16 2 A 1.0001 1.0001 0 0 0 14.984375 0.98632812 z M 5.796875 4.7988281 A 1.0001 1.0001 0 0 0 5.1015625 6.515625 L 7.2226562 8.6367188 A 1.0001 1.0001 0 1 0 8.6367188 7.2226562 L 6.515625 5.1015625 A 1.0001 1.0001 0 0 0 5.796875 4.7988281 z M 24.171875 4.7988281 A 1.0001 1.0001 0 0 0 23.484375 5.1015625 L 21.363281 7.2226562 A 1.0001 1.0001 0 1 0 22.777344 8.6367188 L 24.898438 6.515625 A 1.0001 1.0001 0 0 0 24.171875 4.7988281 z M 15 8 A 7 7 0 0 0 8 15 A 7 7 0 0 0 15 22 A 7 7 0 0 0 22 15 A 7 7 0 0 0 15 8 z M 2 14 A 1.0001 1.0001 0 1 0 2 16 L 5 16 A 1.0001 1.0001 0 1 0 5 14 L 2 14 z M 25 14 A 1.0001 1.0001 0 1 0 25 16 L 28 16 A 1.0001 1.0001 0 1 0 28 14 L 25 14 z M 7.9101562 21.060547 A 1.0001 1.0001 0 0 0 7.2226562 21.363281 L 5.1015625 23.484375 A 1.0001 1.0001 0 1 0 6.515625 24.898438 L 8.6367188 22.777344 A 1.0001 1.0001 0 0 0 7.9101562 21.060547 z M 22.060547 21.060547 A 1.0001 1.0001 0 0 0 21.363281 22.777344 L 23.484375 24.898438 A 1.0001 1.0001 0 1 0 24.898438 23.484375 L 22.777344 21.363281 A 1.0001 1.0001 0 0 0 22.060547 21.060547 z M 14.984375 23.986328 A 1.0001 1.0001 0 0 0 14 25 L 14 28 A 1.0001 1.0001 0 1 0 16 28 L 16 25 A 1.0001 1.0001 0 0 0 14.984375 23.986328 z"></path>
                        </svg>
                    `;
                    break
                case "active":
                    switchMenu.innerHTML = `
                    <svg
                            width="210mm"
                            height="297mm"
                            viewBox="0 0 210 245"
                            version="1.1"
                            id="svg5"
                            xml:space="preserve"
                            inkscape:export-filename="bitmap.png"
                            inkscape:export-xdpi="96"
                            inkscape:export-ydpi="96"
                            xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
                            xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
                            xmlns="http://www.w3.org/2000/svg"
                            xmlns:svg="http://www.w3.org/2000/svg"><sodipodi:namedview
                              id="namedview7"
                              pagecolor="#ffffff"
                              bordercolor="#000000"
                              borderopacity="0.25"
                              inkscape:showpageshadow="2"
                              inkscape:pageopacity="0.0"
                              inkscape:pagecheckerboard="0"
                              inkscape:deskcolor="#d1d1d1"
                              inkscape:document-units="mm"
                              showgrid="false" /><defs
                              id="defs2" /><g
                              inkscape:label="Layer 1"
                              inkscape:groupmode="layer"
                              id="layer1"><path
                                d="M 93.981802,225.1995 C 66.61878,218.32002 42.650841,198.22258 30.536621,171.99978 24.485286,158.90085 23.322046,152.8786 23.258929,134.32179 c -0.06408,-18.84371 0.993554,-24.3765 7.202569,-37.677916 8.750316,-18.74566 24.691776,-35.857158 41.357427,-44.392979 6.741023,-3.452559 12.700253,-6.277411 13.242738,-6.277411 0.542485,0 -1.134454,6.138925 -3.726513,13.642005 -15.083001,43.660091 6.883122,92.300701 50.98485,112.898121 13.54916,6.32808 18.73854,7.28165 39.62697,7.28165 13.21985,0 24.03603,0.7505 24.03595,1.66776 -8e-5,0.91733 -5.33829,7.60516 -11.86268,14.86185 -22.02064,24.49222 -59.63871,36.5427 -90.138438,28.87463 z"
                                id="path194" /></g></svg>              
                    `;
                    break
            }
        }
    }

    function getUserTheme() {
        const theme = JSON.parse(localStorage.getItem("theme"));

        if (!isNaN(theme)) {

            localStorage.setItem("theme", JSON.stringify("sys"));
            userTheme = getAutoTheme();
            setUpMode("sys", userTheme);
            return;
        }

        switch(theme) {
            case "active":
                document.documentElement.classList.add("dark-theme");
                setUpMode(theme);
                break
            case "sys":
                userTheme = getAutoTheme();
                setUpMode(theme, userTheme);
                break
            case "disactive":
                document.documentElement.classList.remove("dark-theme");
                setUpMode(theme);
                break
            default:
                getAutoTheme();
                localStorage.setItem("theme", JSON.stringify("sys"));

                setUpMode("sys");
        }
    }

    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
        getAutoTheme();
    });

    getUserTheme();
</script>